# PHP CTF 题目集

本题目集包含10道PHP CTF题目，涵盖以下考察方向：

## 题目列表

| 题号 | 题目名称 | 考察点 | 难度 | 类型 | Flag |
|------|----------|--------|------|------|------|
| 1 | 弱类型比较 | PHP弱类型、松散比较、MD5碰撞、strcmp绕过 | 简单 | 单文件 | `flag{php_w3ak_typ3_1s_d4ng3r0us}` |
| 2 | 反序列化入门 | 反序列化漏洞、魔术方法、__wakeup绕过 | 简单 | 单文件 | `flag{uns3r1al1z3_m4g1c_m3th0d}` |
| 3 | 文件包含与伪协议 | LFI、PHP伪协议、Filter链、大小写绕过 | 中等 | 多文件 | `flag{php_pr0t0c0l_1s_p0w3rful}` |
| 4 | 命令执行绕过 | 命令注入、黑名单绕过、通配符 | 中等 | 单文件 | `flag{c0mm4nd_1nj3ct10n_byp4ss}` |
| 5 | SQL注入与WAF绕过 | SQLite注入、WAF绕过、换行符绕过 | 中等 | 多文件 | `flag{sql_1nj3ct10n_w4f_byp4ss}` |
| 6 | 反序列化POP链 | POP链构造、多类组合利用、魔术方法调用链 | 困难 | 多文件 | `flag{p0p_ch41n_m4st3r_2024}` |
| 7 | SSRF与内网探测 | SSRF漏洞、IP地址绕过、协议绕过 | 中等 | 单文件 | `flag{ssrf_1nt3rn4l_s3rv1c3}` |
| 8 | 条件竞争 | 竞态条件、文件上传、临时文件利用 | 困难 | 多文件 | `flag{r4c3_c0nd1t10n_w1n}` |
| 9 | 变量覆盖 | extract()、$$可变变量、变量覆盖漏洞 | 中等 | 单文件 | `flag{v4r14bl3_0v3rwr1t3}` |
| 10 | Session反序列化 | Session处理器差异、序列化格式注入 | 困难 | 多文件 | `flag{s3ss10n_d3s3r14l1z3_m4st3r}` |

## 考察方向覆盖

1. **弱类型漏洞**: 题目1
2. **反序列化漏洞**: 题目2, 6, 10
3. **文件包含漏洞**: 题目3
4. **命令执行漏洞**: 题目4
5. **SQL注入漏洞**: 题目5
6. **SSRF漏洞**: 题目7
7. **条件竞争**: 题目8
8. **变量覆盖**: 题目9
9. **Session安全**: 题目10

## 使用说明

1. 将题目部署到支持PHP的Web服务器上（推荐PHP 7.4+）
2. 部分题目需要额外配置（如数据库、文件权限等）
3. 每道题目都包含详细的Writeup（在源码注释中）
4. 预期的flag格式：`flag{xxxxx}`

## 目录结构

```
php questions/
├── 题目说明.md
├── 01-弱类型比较/
│   └── index.php
├── 02-反序列化入门/
│   └── index.php
├── 03-文件包含与伪协议/
│   ├── index.php
│   ├── flag.php
│   └── welcome.php
├── 04-命令执行绕过/
│   └── index.php
├── 05-SQL注入与WAF绕过/
│   └── index.php (会自动创建SQLite数据库)
├── 06-反序列化POP链/
│   ├── index.php
│   ├── flag
│   └── poc.php
├── 07-SSRF与内网探测/
│   └── index.php
├── 08-条件竞争/
│   ├── index.php
│   ├── flag
│   └── poc.py
├── 09-变量覆盖/
│   └── index.php
└── 10-Session反序列化/
    ├── index.php
    ├── reader.php
    └── poc.php
```

## 注意事项

- 部分题目需要在Linux环境下运行
- 题目4的flag需要手动创建 `/flag` 文件
- 题目5使用SQLite，会自动创建数据库文件
- 题目8需要创建 `uploads/` 目录并设置可写权限
- 所有Writeup仅供学习参考，实际CTF比赛中不会提供
